<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Transform your emails into actionable insights with AI-powered analysis">
    <title>EmailWise - Intelligent Email Analysis</title>

    <!-- Bootstrap CSS with dark theme -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Google Fonts: Outfit for headings, Inter for body -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>

<body>
    <!-- Advanced Animated Background -->
    <div class="bg-canvas">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <nav class="navbar navbar-expand-lg fixed-top py-4">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-2" href="#">
                <div class="glass-card d-flex align-items-center justify-content-center"
                    style="width:40px; height:40px; border-radius:12px;">
                    <i class="fas fa-bolt text-warning"></i>
                </div>
                <span class="brand-text fw-bold fs-4 text-white">EmailWise</span>
            </a>
        </div>
    </nav>

    <main class="container py-5 mt-5">
        <!-- Hero Section -->
        <header class="hero-box animate-enter">
            <div class="d-inline-flex align-items-center gap-2 px-3 py-1 rounded-pill glass-card mb-4 border-primary">
                <span class="pulse-dot"></span>
                <span class="small fw-medium text-white">AI Engine v2.0 Live</span>
            </div>

            <h1 class="display-2 mb-3 fw-bold hero-title">
                Unleash Your <br />
                <span class="text-gradient-primary">Inbox Intelligence</span>
            </h1>

            <p class="lead text-muted mx-auto" style="max-width: 600px;">
                Transform chaotic email threads into crystal-clear actions, summaries, and decisions with our advanced
                neural engine.
            </p>

            <div class="hero-stats animate-enter delay-100">
                <div class="text-start">
                    <h5 class="mb-0 fw-bold text-white">50k+</h5>
                    <small class="text-muted text-xs text-uppercase tracking-wide">Chars / Email</small>
                </div>
                <div class="vr bg-white opacity-25"></div>
                <div class="text-start">
                    <h5 class="mb-0 fw-bold text-white">0.5s</h5>
                    <small class="text-muted text-xs text-uppercase tracking-wide">Analysis Time</small>
                </div>
                <div class="vr bg-white opacity-25"></div>
                <div class="text-start">
                    <h5 class="mb-0 fw-bold text-white">100%</h5>
                    <small class="text-muted text-xs text-uppercase tracking-wide">Secure</small>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="row justify-content-center">
            <div class="col-lg-10">

                <!-- Input Card -->
                <div class="glass-card p-4 p-md-5 mb-5 animate-enter delay-200">
                    <form id="emailForm">
                        <div class="row g-4">
                            <!-- Main Input Area -->
                            <div class="col-lg-8">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <label for="emailContent" class="form-label mb-0 fw-bold text-white">
                                        <i class="far fa-envelope me-2"></i>Email Content
                                    </label>
                                    <div class="d-flex gap-2">
                                        <button type="button" class="btn btn-sm btn-outline-light-soft sorted-btn"
                                            id="pasteBtn">
                                            <i class="far fa-clipboard me-1"></i> Paste
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-light-soft sorted-btn"
                                            id="clearBtn">
                                            <i class="fas fa-trash-alt me-1"></i> Clear
                                        </button>
                                    </div>
                                </div>

                                <div class="position-relative mb-3">
                                    <textarea class="form-control glass-input" id="emailContent" rows="14"
                                        placeholder="Paste your long email thread here..." required></textarea>
                                </div>

                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted" id="charCount">0 characters</small>

                                    <!-- Attachment Dropzone Trigger -->
                                    <div class="d-flex align-items-center">
                                        <input type="file" id="attachmentInput" class="d-none" multiple>
                                        <button type="button"
                                            class="btn btn-sm btn-outline-light-soft rounded-pill px-3"
                                            id="uploadTrigger">
                                            <i class="fas fa-paperclip me-2 text-primary"></i>Attach PDF / Doc
                                        </button>
                                    </div>
                                </div>
                                <div id="fileList" class="mt-3 text-white-50 small ps-1"></div>
                            </div>

                            <!-- Analysis Options Panel -->
                            <div class="col-lg-4">
                                <div class="h-100 d-flex flex-column gap-3">
                                    <div class="p-4 rounded-4"
                                        style="background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.05);">
                                        <h6 class="text-white fw-bold mb-4"><i
                                                class="fas fa-sliders-h me-2 text-accent"></i>Configuration</h6>

                                        <!-- Summary Style -->
                                        <div class="mb-4">
                                            <label
                                                class="form-label text-muted text-xs text-uppercase tracking-wide fw-bold mb-2">Detailed
                                                Level</label>
                                            <select class="form-select glass-select" id="summaryStyle">
                                                <option value="detailed" selected>Deep Analysis</option>
                                                <option value="quick">Quick Overview</option>
                                                <option value="brief">Executive Brief</option>
                                            </select>
                                        </div>

                                        <!-- Output Language -->
                                        <div class="mb-4">
                                            <label
                                                class="form-label text-muted text-xs text-uppercase tracking-wide fw-bold mb-2">Output
                                                Language</label>
                                            <select class="form-select glass-select" id="outputLanguage">
                                                <option value="english" selected>English (US)</option>
                                                <option value="spanish">Spanish</option>
                                                <option value="french">French</option>
                                                <option value="german">German</option>
                                                <option value="hindi">Hindi</option>
                                            </select>
                                        </div>

                                        <!-- Reply Tone -->
                                        <div class="mb-2">
                                            <label
                                                class="form-label text-muted text-xs text-uppercase tracking-wide fw-bold mb-2">AI
                                                Persona Tone</label>
                                            <select class="form-select glass-select" id="replyTone">
                                                <option value="professional" selected>Professional</option>
                                                <option value="friendly">Friendly & Warm</option>
                                                <option value="strict">Strict & Direct</option>
                                                <option value="empathetic">Empathetic</option>
                                            </select>
                                        </div>
                                    </div>

                                    <button type="submit" class="btn btn-primary w-100 py-3 mt-auto shadow-lg"
                                        id="analyzeBtn">
                                        <span class="btn-text fw-bold">
                                            <i class="fas fa-sparkles me-2"></i>Generate Insights
                                        </span>
                                        <div class="spinner-border spinner-border-sm d-none" id="btnLoadingSpinner"
                                            role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Error Alert -->
                <div class="alert alert-custom d-none fade mb-4" role="alert" id="errorAlert">
                    <div class="d-flex align-items-center">
                        <div class="alert-icon-box me-3">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div id="errorMessage">An error occurred while analyzing the email.</div>
                        <button type="button" class="btn-close btn-close-white ms-auto" id="closeError"></button>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="d-none">

                    <div class="d-flex align-items-center justify-content-between mb-4 animate-enter">
                        <h3 class="fw-bold mb-0 text-white">Analysis Report</h3>
                        <div class="glass-card px-3 py-2 d-flex align-items-center gap-2">
                            <span class="text-muted small">Confidence</span>
                            <span class="fw-bold text-success" id="mainConfidenceBadge">--%</span>
                        </div>
                    </div>

                    <!-- Quick Actions Toolbar -->
                    <div
                        class="glass-card p-3 mb-4 d-flex align-items-center justify-content-between animate-enter delay-50">
                        <span class="text-xs fw-bold text-muted text-uppercase tracking-wide">Quick Actions</span>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-light-soft action-btn" data-action="archive">
                                <i class="fas fa-archive me-1"></i> Archive
                            </button>
                            <button class="btn btn-sm btn-outline-light-soft action-btn" data-action="snooze">
                                <i class="fas fa-clock me-1"></i> Snooze
                            </button>
                            <button class="btn btn-sm btn-outline-light-soft action-btn" data-action="delegate">
                                <i class="fas fa-user-friends me-1"></i> Delegate
                            </button>
                            <button class="btn btn-sm btn-outline-light-soft action-btn" data-action="mark_read">
                                <i class="fas fa-check-double me-1"></i> Mark Read
                            </button>
                        </div>
                    </div>

                    <!-- AI Intelligence Pipeline -->
                    <div id="resultsContent" class="result-group">

                        <!-- 1. The Head-Up Display (Highlights) -->
                        <div class="row g-3 animate-enter delay-100">
                            <div class="col-md-3">
                                <div class="glass-card p-3 text-center h-100 d-flex flex-column justify-content-center">
                                    <h6 class="text-uppercase text-muted text-xs tracking-wide mb-2 opacity-75">Intent
                                    </h6>
                                    <div id="intentBadge" class="fw-bold text-white fs-5">Analyzing...</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="glass-card p-3 text-center h-100 d-flex flex-column justify-content-center">
                                    <h6 class="text-uppercase text-muted text-xs tracking-wide mb-2 opacity-75">Urgency
                                    </h6>
                                    <div id="urgencyBadge" class="fw-bold fs-3">--/10</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="glass-card p-3 text-center h-100 d-flex flex-column justify-content-center">
                                    <h6 class="text-uppercase text-muted text-xs tracking-wide mb-2 opacity-75">Tone
                                    </h6>
                                    <div id="sentimentBadge" class="fs-5">Analyzing...</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="glass-card p-3 text-center h-100 d-flex flex-column justify-content-center">
                                    <h6 class="text-uppercase text-muted text-xs tracking-wide mb-2 opacity-75">Trust
                                    </h6>
                                    <div id="confidenceBadge" class="text-success fw-bold fs-5">--%</div>
                                </div>
                            </div>
                        </div>

                        <!-- 2. Spam Alert (Hidden by default) -->
                        <div id="spamAlert" class="alert alert-custom d-flex align-items-center d-none animate-enter"
                            role="alert">
                            <i class="fas fa-shield-virus fa-2x me-3"></i>
                            <div>
                                <h5 class="alert-heading mb-1 fw-bold">Security Alert</h5>
                                <p class="mb-0 small opacity-75" id="spamReason">Analysis indicates high likelihood of
                                    phishing or scam intent.</p>
                            </div>
                        </div>

                        <!-- 3. Decision Helper (Hidden by default) -->
                        <div id="decisionCard"
                            class="glass-card p-4 border-warning border-opacity-25 d-none animate-enter">
                            <div class="d-flex align-items-center gap-2 mb-4">
                                <div class="icon-box bg-soft-warning text-warning">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <h5 class="mb-0 fw-bold">Strategic Decision Helper</h5>
                            </div>
                            <div class="row g-4">
                                <div class="col-md-4">
                                    <h6 class="text-success mb-3 fw-bold small text-uppercase">Pros / Benefits</h6>
                                    <ul class="list-unstyled text-muted small" id="prosList"></ul>
                                </div>
                                <div class="col-md-4">
                                    <h6 class="text-danger mb-3 fw-bold small text-uppercase">Cons / Downsides</h6>
                                    <ul class="list-unstyled text-muted small" id="consList"></ul>
                                </div>
                                <div class="col-md-4">
                                    <h6 class="text-warning mb-3 fw-bold small text-uppercase">Risks & Blockers</h6>
                                    <ul class="list-unstyled text-muted small" id="risksList"></ul>
                                </div>
                            </div>
                        </div>

                        <!-- 4. Main Content Extraction -->
                        <div class="row g-4 animate-enter delay-200">
                            <!-- Executive Summary -->
                            <div class="col-12">
                                <div class="glass-card p-4">
                                    <div class="d-flex align-items-center justify-content-between mb-3">
                                        <div class="d-flex align-items-center gap-2">
                                            <i class="fas fa-stream text-primary"></i>
                                            <h5 class="mb-0 fw-bold">Executive Summary</h5>
                                        </div>
                                        <button class="btn btn-icon btn-sm" data-target="summaryContent"><i
                                                class="far fa-copy"></i></button>
                                    </div>
                                    <div id="summaryContent" class="content-area"></div>
                                </div>
                            </div>

                            <!-- Actions & Deadlines Split -->
                            <div class="col-md-6">
                                <div class="glass-card p-4 h-100">
                                    <div class="d-flex align-items-center justify-content-between mb-3">
                                        <div class="d-flex align-items-center gap-2">
                                            <i class="fas fa-tasks text-accent"></i>
                                            <h5 class="mb-0 fw-bold">Action Items</h5>
                                        </div>
                                        <button class="btn btn-icon btn-sm" data-target="actionItemsContent"><i
                                                class="far fa-copy"></i></button>
                                    </div>
                                    <div id="actionItemsContent" class="content-area"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="glass-card p-4 h-100">
                                    <div class="d-flex align-items-center justify-content-between mb-3">
                                        <div class="d-flex align-items-center gap-2">
                                            <i class="fas fa-calendar-alt text-danger"></i>
                                            <h5 class="mb-0 fw-bold">Key Deadlines</h5>
                                        </div>
                                        <button class="btn btn-icon btn-sm" data-target="deadlinesContent"><i
                                                class="far fa-copy"></i></button>
                                    </div>
                                    <div id="deadlinesContent" class="content-area"></div>
                                </div>
                            </div>
                        </div>

                        <!-- 5. Smart Replies (Tabbed) -->
                        <div class="glass-card p-0 overflow-hidden animate-enter delay-300">
                            <div class="p-4 bg-white bg-opacity-05 border-bottom border-white-10">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center gap-2">
                                        <i class="fas fa-reply-all text-success"></i>
                                        <h5 class="mb-0 fw-bold">Draft Replies</h5>
                                    </div>

                                    <ul class="nav nav-pills gap-2" id="replyTabs" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link active btn-sm rounded-pill py-1 px-3 fw-medium"
                                                id="reply-1-tab" data-bs-toggle="pill" data-bs-target="#reply-1"
                                                type="button">Option 1: Direct</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link btn-sm rounded-pill py-1 px-3 fw-medium"
                                                id="reply-2-tab" data-bs-toggle="pill" data-bs-target="#reply-2"
                                                type="button">Option 2: Alt</button>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div class="p-4">
                                <div class="tab-content" id="replyTabContent">
                                    <div class="tab-pane fade show active" id="reply-1" role="tabpanel">
                                        <div class="position-relative">
                                            <div id="replyContent1"
                                                class="content-area text-white opacity-75 font-monospace small bg-black bg-opacity-25 p-3 rounded-3">
                                            </div>
                                            <button
                                                class="btn btn-icon btn-sm text-white position-absolute top-0 end-0 m-2"
                                                data-target="replyContent1"><i class="far fa-copy"></i></button>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="reply-2" role="tabpanel">
                                        <div class="position-relative">
                                            <div id="replyContent2"
                                                class="content-area text-white opacity-75 font-monospace small bg-black bg-opacity-25 p-3 rounded-3">
                                            </div>
                                            <button
                                                class="btn btn-icon btn-sm text-white position-absolute top-0 end-0 m-2"
                                                data-target="replyContent2"><i class="far fa-copy"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 6. Chat with Email Context -->
                        <div class="glass-card mt-4 p-0 overflow-hidden animate-enter delay-300">
                            <div
                                class="p-3 bg-white bg-opacity-05 border-bottom border-white border-opacity-10 d-flex align-items-center gap-2">
                                <i class="fas fa-comments text-info"></i>
                                <h6 class="mb-0 fw-bold text-white">Interactive Assistant</h6>
                            </div>
                            <div class="p-3" style="min-height: 200px; max-height: 350px; overflow-y: auto;"
                                id="chatHistory">
                                <div class="text-muted text-center small mt-4 opacity-50">
                                    <i class="fas fa-question-circle mb-2"></i><br>
                                    Ask follow-up questions about the email content here.
                                </div>
                            </div>
                            <div class="p-3 border-top border-white border-opacity-10 bg-black bg-opacity-25">
                                <div class="input-group">
                                    <input type="text" class="form-control glass-input border-0" id="chatInput"
                                        placeholder="Ask a question..."
                                        style="background: transparent !important; box-shadow: none !important;">
                                    <button class="btn btn-primary rounded-end-pill px-4" type="button"
                                        id="chatSendBtn">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- History Section -->
                <div class="history-section mt-5 pt-5 border-top border-white-10">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4 class="h5 fw-bold mb-0 text-muted">Recent Analysis History</h4>
                        <div class="d-flex gap-2">
                            <button
                                class="btn btn-sm btn-link text-danger text-decoration-none opacity-75 hover-opacity-100"
                                id="clearHistoryBtn">
                                <i class="fas fa-trash-alt me-1"></i> Clear
                            </button>
                            <button
                                class="btn btn-sm btn-link text-muted text-decoration-none opacity-75 hover-opacity-100"
                                id="refreshHistoryBtn">
                                <i class="fas fa-sync-alt me-1"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div id="historyContent" class="history-list">
                        <!-- History items will be injected here -->
                        <div class="text-center py-5 text-muted opacity-25">
                            <i class="far fa-clock fa-3x mb-3"></i>
                            <p>No recent activity</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="py-5 mt-5 text-center text-muted border-top border-white-10">
        <small class="opacity-50">&copy; 2025 EmailWise. Powered by Advanced Neural Engines.</small>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>

</html>